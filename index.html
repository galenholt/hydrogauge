<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Pulls information from the Kisters Kiwis and Hydstra APIs • hydrogauge</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Pulls information from the Kisters Kiwis and Hydstra APIs">
<meta name="description" content="This package provides R wrappers to (some) of the API calls possible to the Kisters Kiwis and Hydstra APIs. Its focus was initially for Victoria, Australia using Hydstra, and is best-tested there, but expansion to BOM has brought in KiWis. Both are likely to be generic across other jurisdictions using these services. I have tried to provide functionality to query available options for the different arguments.">
<meta property="og:description" content="This package provides R wrappers to (some) of the API calls possible to the Kisters Kiwis and Hydstra APIs. Its focus was initially for Victoria, Australia using Hydstra, and is best-tested there, but expansion to BOM has brought in KiWis. Both are likely to be generic across other jurisdictions using these services. I have tried to provide functionality to query available options for the different arguments.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">hydrogauge</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9010</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/hydrogauge.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/hydrogauge.html">hydrogauge</a></li>
    <li><a class="dropdown-item" href="articles/hydstra-traces-workflow.html">hydstra workflow</a></li>
    <li><a class="dropdown-item" href="articles/kiwis-workflow.html">KiWIS workflow</a></li>
    <li><a class="dropdown-item" href="articles/hydstra-wrapper.html">hydstra wrapper</a></li>
    <li><a class="dropdown-item" href="articles/kiwis-wrapper.html">KiWIS wrapper</a></li>
    <li><a class="dropdown-item" href="articles/data-portals.html">Data portals</a></li>
    <li><a class="dropdown-item" href="articles/BOM_quality_codes.html">BOM quality codes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/galenholt/hydrogauge/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="hydrogauge">hydrogauge<a class="anchor" aria-label="anchor" href="#hydrogauge"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>hydrogauge is designed to query <a href="https://resources.kisters.com.au/public/kisters-web-publishing/" class="external-link">Kisters</a> Hydstra (hydllp) and Kisters WISKI/KiWIS water gauge APIs. It does not have complete API coverage, but tries to expose more than many other gauge-pulling packages. Please leave functionality requests in github issues.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of hydrogauge from <a href="https://github.com/galenholt/hydrogauge" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"galenholt/hydrogauge"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>This package was originally conceived to enable a workflow of querying to discover data availability (variables, time spans, locations), followed by pulling data based on those findings. This differs from other, more tailored, approaches to e.g. pulling flow gauges for a specific location, trading off querying ability with ease of use.</p>
<p>hydrogauge attempts to smooth out this tradeoff by providing a set of core functions that give the user access to most of the API functionality using syntax as close to API documentation as possible, as well as a set of wrapper functions that attempt to make the most common use-cases easier and avoid the need to dig into API documentation.</p>
<p>This package was originally designed to query various Australian state water gauge networks and the Australian Bureau of Meteorology (BoM) APIs. Some Australian states use <a href="https://resources.kisters.com.au/public/kisters-web-publishing/" class="external-link">Kisters</a> Hydstra (hydllp) while the BoM uses Kisters WISKI/KiWIS. Thus, this package is best-tested agains Australian data sources, but is likely to work for many other services use these APIs with a simple change to the URL (argument <code>portal</code>).</p>
<div class="section level3">
<h3 id="api-and-wrapper-functions">API and wrapper functions<a class="anchor" aria-label="anchor" href="#api-and-wrapper-functions"></a>
</h3>
<p>The core functions try to stay as close as possible to simple translations of arguments from R to Kisters formats, and of output JSON back to R. This approach lets us get closer to exposing the full functionality and makes for clearer mapping to the <a href="https://kisters.com.au/doco/hydllp.htm" class="external-link">Kisters documentation</a>. The goal here is to expose as much functionality as possible and avoid making too many decisions for the user.</p>
<p>hydrogauge provides convenience functions (primarly <code>fetch_timeseries</code>, <code>fetch_kiwis_timeseries</code>, and <code>fetch_hydstra_timeseries</code>) that automate some of the workflow (such as querying period of record and pulling that range). With the recent inclusion of BoM gauges in WISKi/KiWIS format, it is likely that harmonized wrapper functions will be developed to allow calling both types of databases with the same arguments and returning equivalent outputs.</p>
<p>Caveat: while the functionality provided maps as closely as possible to the underlying API calls, that functionality is not complete. This package does not have complete coverage of the available API calls or their arguments, but is under active development to add missing capabilities. Initial focus has been on identifying what is available to pull and pulling timeseries, along with including new data portals.</p>
</div>
<div class="section level3">
<h3 id="supported-sources">Supported sources<a class="anchor" aria-label="anchor" href="#supported-sources"></a>
</h3>
<p>Users can input any url for a KiWIS or HYDSTRA (hydllp) portal, but there are also some that can be called by name (not case sensitive):</p>
<ul>
<li><p>‘vic’: the <a href="https://data.water.vic.gov.au/static.htm" class="external-link">Victorian water data</a> (API url <a href="https://data.water.vic.gov.au/WMIS/cgi/webservice.exe?" class="external-link uri">https://data.water.vic.gov.au/WMIS/cgi/webservice.exe?</a>)</p></li>
<li><p>‘nsw’ : <a href="https://realtimedata.waternsw.com.au/" class="external-link">New South Wales water data</a> (API url <a href="https://realtimedata.waternsw.com.au/cgi/webservice.exe?" class="external-link uri">https://realtimedata.waternsw.com.au/cgi/webservice.exe?</a>)</p></li>
<li><p>‘qld’: <a href="https://water-monitoring.information.qld.gov.au/" class="external-link">Queensland water data</a> (API url <a href="https://water-monitoring.information.qld.gov.au/cgi/webservice.exe?" class="external-link uri">https://water-monitoring.information.qld.gov.au/cgi/webservice.exe?</a>)</p></li>
<li><p>‘bom’: <a href="http://www.bom.gov.au/waterdata" class="external-link">Australian Bureau of Meteorology</a> (API url <a href="http://www.bom.gov.au/waterdata/services" class="external-link uri">http://www.bom.gov.au/waterdata/services</a>)</p></li>
</ul>
<p>Other Australian states are in progress and haven’t been looked into very thoroughly; for the moment, use BoM as a fallback if you don’t know their API urls.</p>
<ul>
<li><p><a href="https://wir.water.wa.gov.au/Pages/Water-Information-Reporting.aspx" class="external-link">WA</a> seems to use HYDSTRA, but the API url hasn’t been found yet.</p></li>
<li><p>Unclear what <a href="https://water.data.sa.gov.au/" class="external-link">SA</a> is using as a backend, but other packages (e.g. python <a href="https://github.com/MDBAuth/MDBA_Gauge_Getter" class="external-link">mdba-gauge-getter</a>) use BOM for SA.</p></li>
<li><p><a href="https://portal.wrt.tas.gov.au/Data" class="external-link">Tasmania</a> and <a href="https://ntg.aquaticinformatics.net/Data" class="external-link">NT</a> have maps that look a lot like BoM</p></li>
</ul>
<p>If you’re outside Australia, just use your URL. Create an issue (or pull request) to add other named portals.</p>
<p>The <a href="https://resources.kisters.com.au/public/kisters-web-publishing/" class="external-link">Kisters website</a> provides a list of sites that are likely to work with these functions, but it may take work to find the correct API url, and those not in the list above are untested.</p>
</div>
</div>
<div class="section level2">
<h2 id="useful-api-documentation">Useful API documentation<a class="anchor" aria-label="anchor" href="#useful-api-documentation"></a>
</h2>
<p>For the base functions that directly access the two APIs, argument names are as close as possible to those used by Kisters. Thus, the API documentation can be very useful in understanding these calls (and identifying not-yet-developed functionality in hydrogauge).</p>
<div class="section level3">
<h3 id="hydstra">HYDSTRA<a class="anchor" aria-label="anchor" href="#hydstra"></a>
</h3>
<p>I have tried to keep the function argument names the same as in the API, and the API restricts the options to the function arguments. The API functions are documented by <a href="https://kisters.com.au/doco/hydllp.htm" class="external-link">Kisters</a> (the creators), and there is a bit more information about options from <a href="https://water-monitoring.information.qld.gov.au/wini/Documents/RDMW_API_doco.pdf" class="external-link">Queensland</a>, though there are discrepancies between states.</p>
</div>
<div class="section level3">
<h3 id="wiskikiwis">WISKI/KiWIS<a class="anchor" aria-label="anchor" href="#wiskikiwis"></a>
</h3>
<p>Most of the documentation I’ve found here is from the <a href="sepa.org.uk">Scottish Environment Protection Agency</a>; I have not found good docs straight from Kisters. The <a href="https://timeseries.sepa.org.uk/KiWIS/KiWIS?datasource=0&amp;service=kisters&amp;type=queryServices&amp;request=getrequestinfo" class="external-link">Kisters docs themselves</a> do seem to be available from SEPA though. These provide information about available functions, allowed variables to request, etc.</p>
<p>A good <a href="https://timeseriesdoc.sepa.org.uk/api-documentation/api-function-reference/principal-query-functions" class="external-link">SEPA walkthrough</a>.</p>
<p>Unlike Hydstra, which provides tailored arguments for different sorts of API control, KiWIS primarily uses text search within columns. This can be more flexible, but means we need to know column names and pay close attention to the regex used to filter those columns to avoid contaminating outputs.</p>
</div>
</div>
<div class="section level2">
<h2 id="similar-packages">Similar packages<a class="anchor" aria-label="anchor" href="#similar-packages"></a>
</h2>
<p>The <a href="https://github.com/buzacott/bomWater" class="external-link">bomWater</a> and <a href="https://github.com/rywhale/kiwisR" class="external-link">kiwisR</a> packages have much of the functionality needed to call the BoM API, targeted at Australia (bomWater) and generally (kiwisR). I have learned a lot from them, and have only chosen to reimplement the BoM work because neither quite had what I needed for my workflow without being convoluted.</p>
<p>There are similar python packages <a href="https://github.com/MDBAuth/MDBA_Gauge_Getter" class="external-link">mdba-gauge-getter</a>, which calls state and BoM, and <a href="github.com/csiro-hydroinformatics/pybomwater">bomwater</a>, which is the BoM interface. Both of these are tailored for flow and stage timeseries, with less emphasis than here on identifying available data and exposing API funcationality.</p>
<p>An obvious missing piece is USGS gauges. The USGS provides the in-house <a href="https://github.com/DOI-USGS/dataRetrieval" class="external-link">dataRetrieval</a> package. At present, I have not explored wrapping that here and doubt that would make sense, given the existing tool.</p>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<p>I have not done much systematic testing of speed for big requests (long periods of record for lots of sites and variables). I am working on optimizing the API calls. It’s certainly possible to overflow your memory if you ask for everything for all sites.</p>
</div>
<div class="section level2">
<h2 id="development-plans">Development plans<a class="anchor" aria-label="anchor" href="#development-plans"></a>
</h2>
<p>This package is under active development, and has been put on github as soon as the main functionality (<code>get_ts_traces</code>) was working. The current high-priority next steps are:</p>
<ul>
<li>
<p>More helpful wrapper functions that automatically detect and pull data</p>
<ul>
<li>Especially across both hydstra and KiWIS</li>
</ul>
</li>
<li>
<p>Selecting and finding sites based on criteria</p>
<ul>
<li>
<em>Especially</em> geographic</li>
</ul>
</li>
<li><p>Diagnostic plots for data inspection, though those will in general be made by the user</p></li>
<li><p>Smarter/faster handling of multiple calls (optimising API calling)</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>Please submit issues on <a href="https://github.com/galenholt/hydrogauge/issues" class="external-link">GitHub</a></p>
<ul>
<li>Galen Holt, <a href="mailto:g.holt@deakin.edu.au" class="email">g.holt@deakin.edu.au</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/galenholt/hydrogauge/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing hydrogauge</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Galen Holt <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7455-9275" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/galenholt/hydrogauge/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/galenholt/hydrogauge/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/galenholt/hydrogauge" class="external-link"><img src="https://codecov.io/gh/galenholt/hydrogauge/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Galen Holt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
