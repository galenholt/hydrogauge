<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get timeseries from Kiwis (BOM) — getTimeseriesValues • hydrogauge</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get timeseries from Kiwis (BOM) — getTimeseriesValues"><meta name="description" content="This expects a ts_id or ts_path (but not both) to identify the timeseries
(&amp;gt;= 1) to pull. ts_path can be generated on the fly with wildcards, but
isn't straightforward to parse- see the output of getTimeseriesList().
Though ts_id would need to be extracted from getTimeseriesList(), and so
may not be any easier to get programatically. The equivalent state (Hydstra)
function is get_ts_traces() (to a close approximation). If period is
used, only one (or none) of start_time and end_time can be used. If
neither is used, it gets the most recent period."><meta property="og:description" content="This expects a ts_id or ts_path (but not both) to identify the timeseries
(&amp;gt;= 1) to pull. ts_path can be generated on the fly with wildcards, but
isn't straightforward to parse- see the output of getTimeseriesList().
Though ts_id would need to be extracted from getTimeseriesList(), and so
may not be any easier to get programatically. The equivalent state (Hydstra)
function is get_ts_traces() (to a close approximation). If period is
used, only one (or none) of start_time and end_time can be used. If
neither is used, it gets the most recent period."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydrogauge</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9010</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hydrogauge.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/hydrogauge.html">hydrogauge</a></li>
    <li><a class="dropdown-item" href="../articles/hydstra-traces-workflow.html">hydstra workflow</a></li>
    <li><a class="dropdown-item" href="../articles/kiwis-workflow.html">KiWIS workflow</a></li>
    <li><a class="dropdown-item" href="../articles/hydstra-wrapper.html">hydstra wrapper</a></li>
    <li><a class="dropdown-item" href="../articles/kiwis-wrapper.html">KiWIS wrapper</a></li>
    <li><a class="dropdown-item" href="../articles/data-portals.html">Data portals</a></li>
    <li><a class="dropdown-item" href="../articles/BOM_quality_codes.html">BOM quality codes</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/galenholt/hydrogauge/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get timeseries from Kiwis (BOM)</h1>
      <small class="dont-index">Source: <a href="https://github.com/galenholt/hydrogauge/blob/HEAD/R/getTimeseriesValues.R" class="external-link"><code>R/getTimeseriesValues.R</code></a></small>
      <div class="d-none name"><code>getTimeseriesValues.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This expects a <code>ts_id</code> or <code>ts_path</code> (but not both) to identify the timeseries
(&gt;= 1) to pull. <code>ts_path</code> can be generated on the fly with wildcards, but
isn't straightforward to parse- see the output of <code><a href="getTimeseriesList.html">getTimeseriesList()</a></code>.
Though <code>ts_id</code> would need to be extracted from <code><a href="getTimeseriesList.html">getTimeseriesList()</a></code>, and so
may not be any easier to get programatically. The equivalent state (Hydstra)
function is <code><a href="get_ts_traces.html">get_ts_traces()</a></code> (to a close approximation). If <code>period</code> is
used, only one (or none) of <code>start_time</code> and <code>end_time</code> can be used. If
neither is used, it gets the most recent period.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getTimeseriesValues</span><span class="op">(</span></span>
<span>  <span class="va">portal</span>,</span>
<span>  ts_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ts_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  period <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  returnfields <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  meta_returnfields <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  extra_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  return_timezone <span class="op">=</span> <span class="st">"UTC"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-portal">portal<a class="anchor" aria-label="anchor" href="#arg-portal"></a></dt>
<dd><p>URL to Kisters KiWIS database.</p></dd>


<dt id="arg-ts-id">ts_id<a class="anchor" aria-label="anchor" href="#arg-ts-id"></a></dt>
<dd><p>timeseries id, typically found from <code><a href="getTimeseriesList.html">getTimeseriesList()</a></code></p></dd>


<dt id="arg-ts-path">ts_path<a class="anchor" aria-label="anchor" href="#arg-ts-path"></a></dt>
<dd><p>timeseries path, which can be constructed, including
wildcards, e.g. <code>ts_path = '*/A4260505/Water*/*DailyMean'</code> Gets the daily
means for all 'Water' variables at gauge A4260505, which might include
Level, Discharge, Temperature, etc..</p></dd>


<dt id="arg-start-time">start_time<a class="anchor" aria-label="anchor" href="#arg-start-time"></a></dt>
<dd><p>character or date or date time for the start <em>in database
default timezone</em>. Default NULL.</p></dd>


<dt id="arg-end-time">end_time<a class="anchor" aria-label="anchor" href="#arg-end-time"></a></dt>
<dd><p>character or date or date time for the end <em>in database
default timezone</em>. Default NULL.</p></dd>


<dt id="arg-period">period<a class="anchor" aria-label="anchor" href="#arg-period"></a></dt>
<dd><p>character, default NULL. The special case 'complete' returns
the full set of data. Otherwise, beginning with 'P', followed by numbers
and characers indicating timespan, e.g. 'P2W'. See
<a href="https://timeseriesdoc.sepa.org.uk/api-documentation/api-function-reference/specifying-date-and-time/" class="external-link">documentation</a>.</p></dd>


<dt id="arg-returnfields">returnfields<a class="anchor" aria-label="anchor" href="#arg-returnfields"></a></dt>
<dd><p>return fields for the data itself. Default is
<code>c('Timestamp', 'Value', 'Quality Code')</code>. Full list from <a href="https://timeseries.sepa.org.uk/KiWIS/KiWIS?datasource=0&amp;service=kisters&amp;type=queryServices&amp;request=getrequestinfo" class="external-link">Kisters docs</a>)</p></dd>


<dt id="arg-meta-returnfields">meta_returnfields<a class="anchor" aria-label="anchor" href="#arg-meta-returnfields"></a></dt>
<dd><p>return fields about the variable and site. seems to
be able to access most of what <code><a href="getTimeseriesList.html">getTimeseriesList()</a></code> has in its
<code>returnfields</code>. Full list from <a href="https://timeseries.sepa.org.uk/KiWIS/KiWIS?datasource=0&amp;service=kisters&amp;type=queryServices&amp;request=getrequestinfo" class="external-link">Kisters docs</a>)</p></dd>


<dt id="arg-extra-list">extra_list<a class="anchor" aria-label="anchor" href="#arg-extra-list"></a></dt>
<dd><p>a named list, see <code><a href="getStationList.html">getStationList()</a></code>, with a special note
that here we can include a 'timezone' argument that determines the timezone
the API returns in. This is dangerous, since the API ingests dates in its
own default timezone and that is inferred from the return in the absence of
the ability to extract it. Thus, including a <code>timezone</code> in <code>extra_list</code> may
yield unexpected outcomes when requesting dates. A better option is to use
<code>return_timezone</code> to adjust the return values. That said, it may be that
some databases return gauge-local tzs, which won't be allowed to be
concatenated. A solution would be to just work in UTC with <code>timezone = 'UTC'</code> in extralist to make all outputs on the same tz.</p></dd>


<dt id="arg-return-timezone">return_timezone<a class="anchor" aria-label="anchor" href="#arg-return-timezone"></a></dt>
<dd><p>character in <code><a href="https://rdrr.io/r/base/timezones.html" class="external-link">OlsonNames()</a></code> or one of three special
cases: <code>'db_default'</code>, <code>'char'</code> or <code>'raw'</code>. Default 'UTC'. If 'db_default',
uses the API default. BOM defaults to +10. If <code>'char'</code> or <code>'raw'</code>, returns
the time column as-is from the API (A string in the format
<code>'YYYY-MM-DDTHH:MM:SS+TZ'</code>)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a tibble of the timeseries values. Times are POSIXct in UTC by
default.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Timezone note: BOM documentation says data is returned in local time. This is
true on the web interface, but not the API. The API defaults to +10, but we
can choose, so here we default to <code>return_timezone = 'UTC'</code> for consistency.
Further, <code>start_time</code> and <code>end_time</code> <em>must</em> be in database-local time;
setting a different return time, either here or directly to the API with a
<code>timezone</code> argument in <code>extra_list</code>, does not affect the interpretation of
these times. <code><a href="getTimeseriesList.html">getTimeseriesList()</a></code> returns the <code>database_timezone</code> to make
this easier. <code><a href="fetch_kiwis_timeseries.html">fetch_kiwis_timeseries()</a></code> handles some of this work
automatically.</p>
<p>Data size note: If you request too much data, this will throw a 500 error.
"Maximum number of timeseries values surpassed. Please narrow your request.
Limit is: 250000" Try to reduce the amount of data being requested in a
single call. The limit in reality seems much lower; I frequently encounter it
when asking for abou 120,000 records</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Galen Holt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

