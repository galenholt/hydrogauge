<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Gets timeseries for sites and variables — get_ts_traces • hydrogauge</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gets timeseries for sites and variables — get_ts_traces"><meta name="description" content="Takes a list of sites and variables and fetches the timeseries. Variables may
include derived and base. This is very similar to the underlying API call,
and does not do very much automation of finding variables, checking times,
etc. If variables are not available for a site or for given times it just
silently does not return them. For a more automated (but currently slower)
approach, see fetch_hydstra_timeseries(), which also allows a
.errorhandling argument."><meta property="og:description" content="Takes a list of sites and variables and fetches the timeseries. Variables may
include derived and base. This is very similar to the underlying API call,
and does not do very much automation of finding variables, checking times,
etc. If variables are not available for a site or for given times it just
silently does not return them. For a more automated (but currently slower)
approach, see fetch_hydstra_timeseries(), which also allows a
.errorhandling argument."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hydrogauge</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9010</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hydrogauge.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/hydrogauge.html">hydrogauge</a></li>
    <li><a class="dropdown-item" href="../articles/hydstra-traces-workflow.html">hydstra workflow</a></li>
    <li><a class="dropdown-item" href="../articles/kiwis-workflow.html">KiWIS workflow</a></li>
    <li><a class="dropdown-item" href="../articles/hydstra-wrapper.html">hydstra wrapper</a></li>
    <li><a class="dropdown-item" href="../articles/kiwis-wrapper.html">KiWIS wrapper</a></li>
    <li><a class="dropdown-item" href="../articles/data-portals.html">Data portals</a></li>
    <li><a class="dropdown-item" href="../articles/BOM_quality_codes.html">BOM quality codes</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/galenholt/hydrogauge/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Gets timeseries for sites and variables</h1>
      <small class="dont-index">Source: <a href="https://github.com/galenholt/hydrogauge/blob/HEAD/R/get_ts_traces.R" class="external-link"><code>R/get_ts_traces.R</code></a></small>
      <div class="d-none name"><code>get_ts_traces.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes a list of sites and variables and fetches the timeseries. Variables may
include derived and base. This is very similar to the underlying API call,
and does not do very much automation of finding variables, checking times,
etc. If variables are not available for a site or for given times it just
silently does not return them. For a more automated (but currently slower)
approach, see <code><a href="fetch_hydstra_timeseries.html">fetch_hydstra_timeseries()</a></code>, which also allows a
<code>.errorhandling</code> argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_ts_traces</span><span class="op">(</span></span>
<span>  <span class="va">portal</span>,</span>
<span>  <span class="va">site_list</span>,</span>
<span>  datasource <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>  var_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"100"</span>, <span class="st">"141"</span><span class="op">)</span>,</span>
<span>  <span class="va">start_time</span>,</span>
<span>  <span class="va">end_time</span>,</span>
<span>  interval <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>  data_type <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  multiplier <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  return_timezone <span class="op">=</span> <span class="st">"UTC"</span>,</span>
<span>  returnformat <span class="op">=</span> <span class="st">"df"</span>,</span>
<span>  .errorhandling <span class="op">=</span> <span class="st">"stop"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-portal">portal<a class="anchor" aria-label="anchor" href="#arg-portal"></a></dt>
<dd><p>character for the data portal (case insensitive). Default
'victoria'</p></dd>


<dt id="arg-site-list">site_list<a class="anchor" aria-label="anchor" href="#arg-site-list"></a></dt>
<dd><p>character site code, either a single site code
<code>"sitenumber"</code>, comma-separated codes in a single string <code>"sitenumber1, sitenumber2</code>, or a vector of site codes <code>c("sitenumber1", "sitenumber2")</code></p></dd>


<dt id="arg-datasource">datasource<a class="anchor" aria-label="anchor" href="#arg-datasource"></a></dt>
<dd><p>character for datasource code. To my knowledge, options are
<code>"A"</code>, <code>"TELEM"</code>, <code>"TELEMCOPY"</code>. Passing multiple not currently supported.</p></dd>


<dt id="arg-var-list">var_list<a class="anchor" aria-label="anchor" href="#arg-var-list"></a></dt>
<dd><p>character vector of variable codes. Needs to be either single
code or vector (<code>c("code1", "code2")</code>), <em>not</em> a comma-separated string</p></dd>


<dt id="arg-start-time">start_time<a class="anchor" aria-label="anchor" href="#arg-start-time"></a></dt>
<dd><p>character, numeric, or date giving the start time. API
expects a 14-digit character <code>"YYYYMMDDHHIIEE"</code>, but this will turn numeric
or dates into that, and pad zeros if given less than 14 digits, e.g.
<code>20200101</code> would be padded to give midnight on 1 Jan 2020.</p></dd>


<dt id="arg-end-time">end_time<a class="anchor" aria-label="anchor" href="#arg-end-time"></a></dt>
<dd><p>character, numeric, or date giving the end time. API expects
a 14-digit character <code>"YYYYMMDDHHIIEE"</code>, but this will turn numeric or
dates into that, and pad zeros if given less than 14 digits, e.g.
<code>20200101</code> would be padded to give midnight on 1 Jan 2020.</p></dd>


<dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd><p>character, period to report. I don't think capitalisation
matters.</p><ul><li><p>Options: <code>"year"</code>, <code>"month"</code>, <code>"day"</code>, <code>"hour"</code>, <code>"minute"</code>, <code>"second"</code>.</p></li>
</ul></dd>


<dt id="arg-data-type">data_type<a class="anchor" aria-label="anchor" href="#arg-data-type"></a></dt>
<dd><p>character, the statistic to apply. <em>Warning:</em> only takes one
value, which is applied to all variables. This may not be appropriate. If
variables should have different statistics, run <code>get_ts_traces</code> multiple
times.</p><ul><li><p>Options: <code>"mean"</code>, <code>"max"</code>, <code>"min"</code>, <code>"start"</code>, <code>"end"</code>, <code>"first"</code>, <code>"last"</code>, <code>"tot"</code>, <code>"maxmin"</code>, <code>"point"</code>, <code>"cum"</code>. Not all are currently tested.</p></li>
</ul></dd>


<dt id="arg-multiplier">multiplier<a class="anchor" aria-label="anchor" href="#arg-multiplier"></a></dt>
<dd><p>character, interval multiplier. I <em>think</em> this allows
intervals like 5 days, by passing <code>interval = 'day'</code> and <code>multiplier = 5</code>.
Not tested other than 1 at present.</p></dd>


<dt id="arg-return-timezone">return_timezone<a class="anchor" aria-label="anchor" href="#arg-return-timezone"></a></dt>
<dd><p>character in <code><a href="https://rdrr.io/r/base/timezones.html" class="external-link">OlsonNames()</a></code> or one of three special
cases: <code>'db_default'</code>, <code>'char'</code> or <code>'raw'</code>. Default 'UTC'. If 'db_default',
uses the API default. If <code>'char'</code>, returns a string in the format
<code>'YYYY-MM-DDTHH:MM:SS+TZ'</code>, having all needed info (and matching Kiwis
returns). If <code>'raw'</code>, returns the time column as-is from the API (a
14-digit string of numbers 'YYYMMDDHHMMSS')</p><ul><li><p><code>"sxvlist"</code> returns a list with an separate tibble for each site x variable combination</p></li>
</ul></dd>


<dt id="arg-returnformat">returnformat<a class="anchor" aria-label="anchor" href="#arg-returnformat"></a></dt>
<dd><p>character, one of</p><ul><li><p><code>"df"</code> returns a tibble</p></li>
<li><p><code>"varlist"</code> returns a list with an separate tibble for each variable (may have multiple sites per tibble)</p></li>
<li><p><code>"sitelist"</code> returns a list with an separate tibble for each site (may have multiple variables per tibble)</p></li>
</ul></dd>


<dt id="arg--errorhandling">.errorhandling<a class="anchor" aria-label="anchor" href="#arg--errorhandling"></a></dt>
<dd><p>as in <code><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach::foreach()</a></code> (but handled in
<code><a href="api_error_catch.html">api_error_catch()</a></code>) Default 'stop'. Made available here primarily to use
'pass' so big requests don't die due to API errors. <strong>Be careful</strong>- those
errors then just get passed and so the data will be missing.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>tibble(s) with requested variables at requested sites (where they
exist). See <code>returnformat</code>, either a tibble or list of tibbles</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Timezone note: Data is returned from the API in local time, but the default
here is to output UTC for consistency. Note, however that the <code>start_time</code>
and <code>end_time</code> <em>must</em> be in database-local time. Thus, when using
programatically, it can be easiest to use <code>'raw'</code> or <code>'db_default'</code>. Further,
the API returns 0 for data outside the range if a request spans across the
boundary. Check your data with <code><a href="get_variable_list.html">get_variable_list()</a></code> or use
<code><a href="fetch_hydstra_timeseries.html">fetch_hydstra_timeseries()</a></code>, which does the check automatically.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">simpletrace</span> <span class="op">&lt;-</span> <span class="fu">get_ts_traces</span><span class="op">(</span></span></span>
<span class="r-in"><span>  portal <span class="op">=</span> <span class="st">'vic'</span>,</span></span>
<span class="r-in"><span>  site_list <span class="op">=</span> <span class="st">"233217"</span>,</span></span>
<span class="r-in"><span>  datasource <span class="op">=</span> <span class="st">"A"</span>,</span></span>
<span class="r-in"><span>  var_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"100"</span>, <span class="st">"141"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  start_time <span class="op">=</span> <span class="st">"20200101"</span>, end_time <span class="op">=</span> <span class="st">"20200105"</span>,</span></span>
<span class="r-in"><span>  interval <span class="op">=</span> <span class="st">"day"</span>, data_type <span class="op">=</span> <span class="st">"mean"</span>,</span></span>
<span class="r-in"><span>  multiplier <span class="op">=</span> <span class="fl">1</span>, returnformat <span class="op">=</span> <span class="st">"df"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Galen Holt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

